# スマホから接続できない場合のトラブルシューティング

## 1. Windowsファイアウォールの設定（最も多い原因）

### 方法A: スクリプトで自動設定（推奨）

**管理者権限でPowerShellを開いて実行：**

```powershell
cd "c:\Users\PC user\OneDrive\Desktop\udemy-langchain\english-training-app-clean\frontend"
.\allow-firewall.ps1
```

### 方法B: 手動で設定

1. Windowsの検索で「**ファイアウォール**」を検索
2. 「**詳細設定**」をクリック
3. 「**受信の規則**」を選択
4. 右側の「**新しい規則**」をクリック
5. 「**ポート**」を選択 → 次へ
6. 「**TCP**」を選択、「**特定のローカルポート**」に `3001` を入力 → 次へ
7. 「**接続を許可する**」を選択 → 次へ
8. 「**プライベート**」と「**パブリック**」の両方にチェック → 次へ
9. 名前を「**Next.js dev (3001)**」などに設定 → 完了

## 2. ネットワーク接続の確認

### PCとスマホが同じWi-Fiか確認

- **PC**: タスクバーのWi-Fiアイコンをクリック → 接続中のSSIDを確認
- **スマホ**: 設定 → Wi-Fi → 接続中のSSIDを確認
- **同じSSID**であることを確認

### スマホのモバイルデータをオフにする

- 設定 → ネットワーク/インターネット → **モバイルデータをオフ**
- または、クイック設定で **LTE/5Gのアイコンをオフ**

## 3. IPアドレスの確認

### PCのIPアドレスを確認

```powershell
.\show-ip.ps1
```

または

```powershell
ipconfig
```

「**ワイヤレス LAN アダプター**」の **IPv4 アドレス**を確認

### スマホからアクセスするURL

```
http://[PCのIPアドレス]:3001
```

例: `http://192.168.150.69:3001`

## 4. サーバーの起動確認

### サーバーが起動しているか確認

```powershell
netstat -ano | findstr ":3001"
```

以下のように表示されればOK：
```
TCP    0.0.0.0:3001    0.0.0.0:0    LISTENING    [PID]
```

### サーバーを起動

```powershell
npm run dev
```

起動メッセージに以下が表示されることを確認：
```
- Network:      http://0.0.0.0:3001
```

## 5. その他の確認事項

### ルーターの設定

- 「**APアイソレーション（クライアント分離）**」がONになっていると、同じWi-Fi同士でも通信できません
- ルーターの設定でOFFにする

### PCでブラウザからアクセスできるか確認

PCのブラウザで `http://localhost:3001` にアクセスして、正常に表示されるか確認

### エラーメッセージの確認

スマホのブラウザでエラーメッセージを確認：
- **「接続がタイムアウトしました」** → ファイアウォールの問題の可能性が高い
- **「アドレスに到達できません」** → IPアドレスが間違っている、または別ネットワーク

## まとめチェックリスト

- [ ] Windowsファイアウォールでポート3001を許可した
- [ ] PCとスマホが同じWi-Fiに接続されている
- [ ] スマホのモバイルデータがオフになっている
- [ ] サーバーが起動している（`npm run dev`）
- [ ] PCのIPアドレスを確認した（`.\show-ip.ps1`）
- [ ] 正しいURLでアクセスしている（`http://[IP]:3001`）
